(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3370],{3899:function(e,t,n){Promise.resolve().then(n.bind(n,7691))},7691:function(e,t,n){"use strict";n.r(t);var r=n(7437),o=n(2265),a=n(9376),c=n(3464),i=n(8856),l=n(9836),s=n(2615),u=n(6556),d=n(640),f=n.n(d);t.default=()=>{let e=(0,a.useRouter)(),[t,n]=(0,o.useState)(null),[d,h]=(0,o.useState)(!0),m=async()=>{try{let e=(await c.Z.get("".concat(s.p.DOMAIN_URL,"/auth/google/url/immersive_website/"))).data.url;window.location.href=e}catch(e){n("Error al iniciar el flujo de autenticaci\xf3n."),h(!1)}},x=async t=>{try{let{access_token:n,refresh_token:r}=(await c.Z.get("".concat(s.p.DOMAIN_URL,"/auth/google/login/"),{params:{code:t,site:"immersive_website"}})).data;if(n&&r)(0,i.j1)(n),localStorage.setItem("refresh_token",r),e.push("/alvea");else throw Error("Tokens no encontrados en la respuesta.")}catch(e){n("Error al obtener los tokens. Por favor, intenta nuevamente m\xe1s tarde o inicia sesi\xf3n utilizando tu correo electr\xf3nico y contrase\xf1a.")}finally{h(!1)}};return(0,o.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("code");e?x(e):m()},[e]),(0,r.jsxs)(u.hv,{style:{backgroundImage:'url("/img/pixelcut-export.jpeg")',backgroundSize:"cover",backgroundPosition:"center"},children:[(0,r.jsx)(l.Z,{}),(0,r.jsx)("div",{className:"".concat(f()["card-glass"]," m-3"),children:(0,r.jsx)("div",{className:"flex flex-col justify-center text-center",children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-xl lg:text-2xl font-bold text-center",children:"Redirigiendo a Google "}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(u.$j,{isVisible:d})})]}):t?(0,r.jsx)("p",{className:"text-red-500 font-bold text-center",children:t}):(0,r.jsx)("h2",{className:"text-xl lg:text-2xl font-bold text-center",children:"Autenticaci\xf3n completada"})})})]})}},6556:function(e,t,n){"use strict";n.d(t,{$j:function(){return i},hv:function(){return u},iz:function(){return l},tw:function(){return s}});var r=n(7437);n(2265);var o=n(1994),a=n(8163),c=n.n(a);function i(e){let{isVisible:t,className:n,...a}=e;return t?(0,r.jsx)("div",{className:(0,o.Z)(c().spinner,n),...a}):null}function l(){return(0,r.jsx)("div",{className:"w-4/5 mx-auto border-t-2 border-gray-700"})}function s(e){let{children:t,className:n,...a}=e;return(0,r.jsx)("div",{className:(0,o.Z)("fixed p-3 z-10 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 max-w-lg w-full min-w-[300px]",n),...a,children:t})}function u(e){let{children:t,className:n,...a}=e;return(0,r.jsx)("div",{className:(0,o.Z)("flex justify-center items-center min-h-screen",n),...a,children:t})}n(5925)},9836:function(e,t,n){"use strict";var r=n(7437),o=n(2265),a=n(9376);n(3193),t.Z=()=>{let[e,t]=(0,o.useState)(!1),n=(0,a.useRouter)(),c=()=>{t(!1),n.push("/")};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-black bg-opacity-50 fixed top-10 left-6 z-50 p-2 rounded-full volver",children:(0,r.jsx)("button",{className:" text-white",onClick:c,children:"Volver"})}),e&&(0,r.jsx)("div",{className:"modal-overlay",children:(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsx)("p",{children:"\xbfSeguro que quieres volver al inicio?"}),(0,r.jsx)("button",{className:"confirm-button",onClick:c,children:"Salir"}),(0,r.jsx)("button",{className:"cancel-button",onClick:()=>t(!1),children:"Cancelar"})]})})]})}},8856:function(e,t,n){"use strict";n.d(t,{hP:function(){return i},j1:function(){return c},ni:function(){return l},we:function(){return a},zB:function(){return o}});var r=n(2615);async function o(e,t){if(!e||!t)throw Error("No email or password.");let n=new FormData;n.append("email",e),n.append("password",t);let o="".concat(r.p.DOMAIN_URL,"/auth/login/");return(await fetch(o,{method:"POST",body:n}).then(e=>e.json()).catch(()=>({}))).access_token}async function a(e,t){if(!e||!t)throw Error("No uid or token.");let n=new FormData;n.append("uid",e),n.append("token",t);let o="".concat(r.p.DOMAIN_URL,"/auth/token/"),a=await fetch(o,{method:"POST",body:n}).then(e=>e.ok?e.json():null).catch(()=>null);if(null==a)throw Error("Bad credentials");return a}function c(e){window.localStorage&&window.localStorage.setItem("jwt",e)}function i(){return window.localStorage?window.localStorage.getItem("jwt"):""}function l(){localStorage.removeItem("refresh_token"),localStorage.removeItem("jwt"),window.location.href="/"}},2615:function(e,t,n){"use strict";n.d(t,{p:function(){return o}});var r=n(5566);let o={DOMAIN_WS:r.env.WEBSOCKET_URL,DOMAIN_URL:r.env.DOMAIN_URL,WEBAPP_URL:"/bienvenida/webapp"}},3193:function(){},640:function(e){e.exports={"card-glass":"card-glass_card-glass__rYllw"}},5925:function(e){e.exports={dots:"dots_dots__XPrwp",l5:"dots_l5__zqJ6L"}},8163:function(e){e.exports={spinner:"spinner_spinner__RVr_o",l3:"spinner_l3__k4YcI"}}},function(e){e.O(0,[9197,5921,1251,7444,2971,2117,1744],function(){return e(e.s=3899)}),_N_E=e.O()}]);