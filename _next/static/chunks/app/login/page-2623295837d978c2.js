(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2626],{6453:function(e,t,n){Promise.resolve().then(n.bind(n,738))},738:function(e,t,n){"use strict";n.r(t);var r=n(7437),a=n(2265),s=n(3464),l=n(9376),o=n(8856),i=n(4744),c=n(9836),u=n(2615),d=n(640),p=n.n(d),h=n(7625),x=n.n(h),f=n(6556);t.default=function(){(0,i.Z)("/alvea",null);let e=(0,l.useRouter)(),[t,n]=(0,a.useState)(!0),[d,h]=(0,a.useState)(""),[m,v]=(0,a.useState)(""),[j,g]=(0,a.useState)(""),[N,b]=(0,a.useState)(""),[w,y]=(0,a.useState)(""),[C,_]=(0,a.useState)(""),[k,S]=(0,a.useState)(!1),[R,L]=(0,a.useState)(!1),[I,E]=(0,a.useState)(!1),[O,P]=(0,a.useState)(!1),[A,D]=(0,a.useState)(""),z=()=>{P(!O),_(""),D("")};(0,a.useEffect)(()=>{!async function(){let t=new URLSearchParams(window.location.search),n=t.get("uid"),r=t.get("token");if(n&&r)try{let{access_token:t}=await (0,o.we)(n,r);(0,o.j1)(t),s.Z.defaults.headers.common.Authorization="Bearer ".concat(t),e.push("/alvea")}catch(t){e.push("/login")}}()});let U=e=>{let t=new URLSearchParams;for(let n in e)e[n]&&t.append(n,e[n]);return t},Z=async e=>{e.preventDefault();try{_(""),E(!0),await s.Z.get("".concat(u.p.DOMAIN_URL,"/users/reset-password/?email=").concat(encodeURIComponent(d))),D("Correo de recuperaci\xf3n enviado con \xe9xito.")}catch(e){var t,n;D((null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.detail)||"Error al enviar el correo de recuperaci\xf3n.")}finally{E(!1)}},q=async t=>{t.preventDefault();try{_(""),E(!0);let t=await (0,o.zB)(d,m);if(!t){_("Credenciales inv\xe1lidas. Por favor intente de nuevo.");return}(0,o.j1)(t),s.Z.defaults.headers.common.Authorization="Bearer ".concat(t),e.push("/alvea")}catch(e){var n,r;_((null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.detail)||"Fallo en el inicio de sesi\xf3n. Por favor intente de nuevo."),console.error("Error en el inicio de sesi\xf3n:",e);return}finally{E(!1)}},M=async()=>{e.push("/login/google")},B=async e=>{if(e.preventDefault(),m.length<8){_("La contrase\xf1a debe tener al menos 8 caracteres.");return}if(!/(?=.*\d)/.test(m)){_("La contrase\xf1a debe contener al menos un n\xfamero.");return}if(!/(?=.*[A-Z])/.test(m)){_("La contrase\xf1a debe contener al menos una letra may\xfascula.");return}if(m!==w){_("Las contrase\xf1as no coinciden.");return}try{_(""),E(!0),await s.Z.post("".concat(u.p.DOMAIN_URL,"/auth/register/"),U({email:d,password:m,firstname:j,lastname:N}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}),n(!0)}catch(e){var t,r;_((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.detail)||"Fallo en el inicio de sesi\xf3n. Por favor intente de nuevo.")}finally{E(!1)}},V=()=>{n(!t),_("")};return(0,r.jsxs)(f.hv,{style:{backgroundImage:'url("/img/pixelcut-export.jpeg")',backgroundSize:"cover",backgroundPosition:"center"},children:[(0,r.jsx)(c.Z,{}),O?(0,r.jsxs)("form",{onSubmit:Z,className:"".concat(p()["card-glass"]," m-3"),children:[(0,r.jsx)("h2",{className:"text-xl lg:text-2xl font-bold text-center",children:"Restablecer contrase\xf1a"}),(0,r.jsx)("input",{type:"email",placeholder:"Correo electr\xf3nico",value:d,onChange:e=>h(e.target.value),className:x()["input-rounded"],required:!0}),(0,r.jsxs)("div",{className:"flex justify-center items-center h-full",children:[A&&(0,r.jsx)("p",{className:"text-red-500 font-bold",children:A}),(0,r.jsx)(f.$j,{isVisible:I})]}),(0,r.jsx)("button",{type:"submit",className:" w-full text-white p-2 lg:p-3 rounded-full bg-foundation-1",children:"Enviar correo de recuperaci\xf3n"}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("p",{onClick:z,className:"underline cursor-pointer",children:"Volver"})})]}):t?(0,r.jsxs)("form",{onSubmit:q,className:"".concat(p()["card-glass"]," m-3"),children:[(0,r.jsx)("h2",{className:"text-xl lg:text-2xl font-bold text-center",children:"Iniciar sesi\xf3n"}),(0,r.jsx)("input",{type:"email",placeholder:"Correo electr\xf3nico",value:d,onChange:e=>h(e.target.value),className:x()["input-rounded"],required:!0}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:k?"text":"password",placeholder:"Contrase\xf1a",value:m,onChange:e=>v(e.target.value),className:x()["input-rounded"],required:!0}),(0,r.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-600",onClick:()=>S(!k),children:(0,r.jsx)("p",{children:k?"Ocultar":"Mostrar"})})]}),(0,r.jsxs)("div",{className:"flex justify-center items-center h-full",children:[C&&(0,r.jsx)("p",{className:"text-red-500 font-bold",children:C}),(0,r.jsx)(f.$j,{isVisible:I})]}),(0,r.jsx)("button",{type:"submit",className:" w-full text-white p-2 lg:p-3 rounded-full bg-foundation-1",children:"Iniciar sesi\xf3n"}),(0,r.jsxs)("div",{className:"flex justify-center space-x-6",children:[(0,r.jsx)("p",{onClick:V,className:"text-center underline cursor-pointer",children:"\xbfNo tienes cuenta?"}),(0,r.jsx)("p",{onClick:z,className:"text-center underline cursor-pointer",children:"\xbfHas olvidado la contrase\xf1a?"})]}),(0,r.jsx)(f.iz,{}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("button",{type:"button",onClick:M,className:"w-full text-black p-3 rounded-full border border-black flex items-center justify-center gap-2",children:[(0,r.jsx)("img",{alt:"Logo de Google",className:"w-6 h-6"}),"Continuar con Google"]})})]}):(0,r.jsxs)("form",{onSubmit:B,className:"".concat(p()["card-glass"]," m-3"),children:[(0,r.jsx)("h2",{className:"text-xl lg:text-2xl font-bold text-center",children:"Registrarse"}),(0,r.jsx)("input",{type:"text",placeholder:"Nombre",value:j,onChange:e=>g(e.target.value),className:x()["input-rounded"],required:!0}),(0,r.jsx)("input",{type:"text",placeholder:"Apellido",value:N,onChange:e=>b(e.target.value),className:x()["input-rounded"],required:!0}),(0,r.jsx)("input",{type:"email",placeholder:"Correo electr\xf3nico",value:d,onChange:e=>h(e.target.value),className:x()["input-rounded"],required:!0}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:k?"text":"password",placeholder:"Contrase\xf1a",value:m,onChange:e=>v(e.target.value),className:x()["input-rounded"],required:!0}),(0,r.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-600",onClick:()=>S(!k),children:(0,r.jsx)("p",{children:k?"Ocultar":"Mostrar"})})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:R?"text":"password",placeholder:"Confirmar contrase\xf1a",value:w,onChange:e=>y(e.target.value),className:x()["input-rounded"],required:!0}),(0,r.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-600",onClick:()=>L(!R),children:(0,r.jsx)("p",{children:R?"Ocultar":"Mostrar"})})]}),(0,r.jsxs)("div",{className:"flex justify-center items-center h-full",children:[C&&(0,r.jsx)("p",{className:"text-red-500 font-bold",children:C}),(0,r.jsx)(f.$j,{isVisible:I})]}),(0,r.jsx)("button",{type:"submit",className:" w-full text-white p-3 rounded-full bg-foundation-1",children:(0,r.jsx)("span",{children:"Registrarse"})}),(0,r.jsxs)("div",{className:"flex justify-center space-x-6",children:[(0,r.jsx)("p",{onClick:V,className:"text-center underline cursor-pointer",children:"\xbfYa tienes una cuenta?"}),(0,r.jsx)("p",{onClick:z,className:"text-center underline cursor-pointer",children:"\xbfHas olvidado la contrase\xf1a?"})]}),(0,r.jsx)(f.iz,{}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("button",{type:"button",onClick:M,className:"w-full text-black p-3 rounded-full border border-black flex items-center justify-center gap-2",children:[(0,r.jsx)("img",{alt:"Logo de Google",className:"w-6 h-6"}),"Continuar con Google"]})})]})]})}},6556:function(e,t,n){"use strict";n.d(t,{$j:function(){return o},hv:function(){return u},iz:function(){return i},tw:function(){return c}});var r=n(7437);n(2265);var a=n(1994),s=n(8163),l=n.n(s);function o(e){let{isVisible:t,className:n,...s}=e;return t?(0,r.jsx)("div",{className:(0,a.Z)(l().spinner,n),...s}):null}function i(){return(0,r.jsx)("div",{className:"w-4/5 mx-auto border-t-2 border-gray-700"})}function c(e){let{children:t,className:n,...s}=e;return(0,r.jsx)("div",{className:(0,a.Z)("fixed p-3 z-10 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 max-w-lg w-full min-w-[300px]",n),...s,children:t})}function u(e){let{children:t,className:n,...s}=e;return(0,r.jsx)("div",{className:(0,a.Z)("flex justify-center items-center min-h-screen",n),...s,children:t})}n(5925)},9836:function(e,t,n){"use strict";var r=n(7437),a=n(2265),s=n(9376);n(3193),t.Z=()=>{let[e,t]=(0,a.useState)(!1),n=(0,s.useRouter)(),l=()=>{t(!1),n.push("/")};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-black bg-opacity-50 fixed top-10 left-6 z-50 p-2 rounded-full volver",children:(0,r.jsx)("button",{className:" text-white",onClick:l,children:"Volver"})}),e&&(0,r.jsx)("div",{className:"modal-overlay",children:(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsx)("p",{children:"\xbfSeguro que quieres volver al inicio?"}),(0,r.jsx)("button",{className:"confirm-button",onClick:l,children:"Salir"}),(0,r.jsx)("button",{className:"cancel-button",onClick:()=>t(!1),children:"Cancelar"})]})})]})}},4744:function(e,t,n){"use strict";var r=n(2265),a=n(9376),s=n(8856),l=n(2615);t.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/login",n=(0,a.useRouter)();(0,r.useEffect)(()=>{(async()=>{let r=(0,s.hP)();if(!r){t&&n.push(t);return}try{let a=await fetch("".concat(l.p.DOMAIN_URL,"/users/me/"),{method:"GET",headers:{Authorization:"Bearer ".concat(r)}});401===a.status||403===a.status?((0,s.j1)(""),t&&n.push(t)):e&&n.push(e)}catch(e){console.error("Error verifying token:",e),t&&n.push(t)}})()},[e,t,n])}},8856:function(e,t,n){"use strict";n.d(t,{hP:function(){return o},j1:function(){return l},ni:function(){return i},we:function(){return s},zB:function(){return a}});var r=n(2615);async function a(e,t){if(!e||!t)throw Error("No email or password.");let n=new FormData;n.append("email",e),n.append("password",t);let a="".concat(r.p.DOMAIN_URL,"/auth/login/");return(await fetch(a,{method:"POST",body:n}).then(e=>e.json()).catch(()=>({}))).access_token}async function s(e,t){if(!e||!t)throw Error("No uid or token.");let n=new FormData;n.append("uid",e),n.append("token",t);let a="".concat(r.p.DOMAIN_URL,"/auth/token/"),s=await fetch(a,{method:"POST",body:n}).then(e=>e.ok?e.json():null).catch(()=>null);if(null==s)throw Error("Bad credentials");return s}function l(e){window.localStorage&&window.localStorage.setItem("jwt",e)}function o(){return window.localStorage?window.localStorage.getItem("jwt"):""}function i(){localStorage.removeItem("refresh_token"),localStorage.removeItem("jwt"),window.location.href="/"}},2615:function(e,t,n){"use strict";n.d(t,{p:function(){return a}});var r=n(5566);let a={DOMAIN_WS:r.env.WEBSOCKET_URL,DOMAIN_URL:r.env.DOMAIN_URL,WEBAPP_URL:"/bienvenida/webapp"}},3193:function(){},640:function(e){e.exports={"card-glass":"card-glass_card-glass__rYllw"}},5925:function(e){e.exports={dots:"dots_dots__XPrwp",l5:"dots_l5__zqJ6L"}},7625:function(e){e.exports={"input-rounded":"input-rounded_input-rounded__wPVC_"}},8163:function(e){e.exports={spinner:"spinner_spinner__RVr_o",l3:"spinner_l3__k4YcI"}}},function(e){e.O(0,[9197,1251,5921,7444,2971,2117,1744],function(){return e(e.s=6453)}),_N_E=e.O()}]);